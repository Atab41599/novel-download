import{_ as C,r as x,d as h,c as n,a as s,j as S,w as o,v as r,g as _,k as d,n as g,F as M,h as E,t as v,i as T,o as i}from"./index-D_MSCiWL.js";import{g as w,A as I}from"./api-CjVlgVfj.js";const L={class:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50"},P={class:"container mx-auto px-4 py-16"},D={class:"max-w-3xl mx-auto glass-card mb-8"},N={class:"space-y-6"},j={class:"settings-grid"},B={class:"form-group"},F={class:"glass-input disabled"},O={class:"form-group"},A={class:"glass-input"},G={class:"form-group"},R={class:"glass-input"},H={class:"form-group"},z={class:"glass-select"},J={class:"form-group"},X={class:"glass-input"},$={class:"form-group"},q={class:"glass-radio-group"},K={class:"glass-radio"},Q={class:"glass-radio"},W={class:"form-group"},Y={class:"glass-radio-group"},Z={class:"glass-radio"},ss={class:"glass-radio"},ts={class:"space-y-6"},es={class:"settings-grid"},ls={class:"form-group"},os={class:"glass-radio-group"},as={class:"glass-radio"},rs={class:"glass-radio"},ns={class:"form-group"},ds={class:"glass-select"},is={class:"form-group"},us={class:"glass-input"},ps={class:"form-group"},vs={class:"flex items-center space-x-2"},ms={class:"glass-input flex-1"},gs={class:"glass-input flex-1"},xs={class:"space-y-6"},bs={class:"settings-grid"},ys={class:"form-group"},fs={class:"glass-input"},cs={class:"form-group"},ws={class:"flex items-center space-x-2"},Is={class:"glass-input flex-1"},_s={class:"glass-input flex-1"},Us={class:"space-y-6"},Vs={class:"settings-grid"},ks={class:"form-group"},Cs={class:"glass-radio-group"},hs={class:"glass-radio"},Ss={class:"glass-radio"},Ms={class:"form-group"},Es=["disabled"],Ts={class:"form-group"},Ls=["disabled"],Ps={class:"form-actions"},Ds=["disabled"],Ns={key:0,class:"spinner",viewBox:"0 0 24 24"},js={key:1},Bs={class:"max-w-3xl mx-auto glass-card"},Fs={class:"overflow-x-auto bg-white bg-opacity-30 rounded-xl"},Os={class:"min-w-full"},As={class:"px-4 py-3 text-sm text-gray-700"},Gs={class:"px-4 py-3 text-sm text-gray-700"},Rs={class:"px-4 py-3"},Hs={class:"px-4 py-3"},zs={class:"px-4 py-3"},Js={class:"px-4 py-3 text-sm text-gray-500 max-w-xs"},Xs={key:0,class:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},$s={key:1,class:"w-5 h-5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},qs={__name:"Setting",setup(Ks){const l=x({}),b=x([]),m=x(!1),u=x({show:!1,type:"success",message:""}),p=(a,t="success")=>{u.value={show:!0,type:t,message:a},setTimeout(()=>{u.value.show=!1},3e3)},U=async()=>{try{m.value=!0;const t=await(await fetch(w(I.CONFIG.GET))).json();t.code===200?l.value=t.data:p(t.msg||"获取配置失败","error");const c=await(await fetch(w(I.CONFIG.GET_SOURCE_INFO))).json();c.code===200?b.value=c.data:p(c.msg||"获取数据源信息失败","error")}catch(a){console.error("获取配置失败:",a),p("获取配置失败，请检查网络连接","error")}finally{m.value=!1}},V=async()=>{try{if(!k(l.value.sourceId)){p(`数据源ID ${l.value.sourceId} 不存在`,"error");return}m.value=!0;const t=await(await fetch(w(I.CONFIG.UPDATE),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l.value)})).json();t.code===200?p("保存成功"):p(t.msg||"保存失败","error")}catch(a){console.error("保存配置失败:",a),p("保存失败，请重试","error")}finally{m.value=!1}};h(()=>{U()});const y=a=>a===null?"inline-flex px-2 py-1 text-xs rounded-full bg-gray-100 bg-opacity-70 text-gray-800":a?"inline-flex px-2 py-1 text-xs rounded-full bg-green-100 bg-opacity-70 text-green-800":"inline-flex px-2 py-1 text-xs rounded-full bg-red-100 bg-opacity-70 text-red-800",f=a=>a===null?"未知":a?"支持":"不支持",k=a=>b.value.some(t=>t.id===a);return(a,t)=>(i(),n("div",L,[s("div",P,[t[61]||(t[61]=s("div",{class:"mb-12 text-center"},[s("h1",{class:"text-4xl font-bold text-gray-900"},"系统设置"),s("p",{class:"mt-2 text-gray-500"},"自定义您的下载和爬取参数")],-1)),s("div",D,[s("form",{onSubmit:S(V,["prevent"]),class:"space-y-8"},[s("div",N,[t[35]||(t[35]=s("h2",{class:"card-title"},"基础设置",-1)),s("div",j,[s("div",B,[t[22]||(t[22]=s("label",{class:"form-label"},"版本",-1)),s("div",F,[o(s("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>l.value.version=e),type:"text",disabled:""},null,512),[[r,l.value.version]])])]),s("div",O,[t[23]||(t[23]=s("label",{class:"form-label"},"书源ID",-1)),s("div",A,[o(s("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>l.value.sourceId=e),type:"number"},null,512),[[r,l.value.sourceId]])])]),s("div",G,[t[24]||(t[24]=s("label",{class:"form-label"},"下载路径",-1)),s("div",R,[o(s("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>l.value.downloadPath=e),type:"text"},null,512),[[r,l.value.downloadPath]])])]),s("div",H,[t[26]||(t[26]=s("label",{class:"form-label"},"文件格式",-1)),s("div",z,[o(s("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>l.value.extName=e)},t[25]||(t[25]=[s("option",{value:"epub"},"EPUB",-1),s("option",{value:"txt"},"TXT",-1),s("option",{value:"html"},"HTML",-1)]),512),[[_,l.value.extName]])])]),s("div",J,[t[27]||(t[27]=s("label",{class:"form-label"},"搜索结果限制",-1)),s("div",X,[o(s("input",{"onUpdate:modelValue":t[4]||(t[4]=e=>l.value.searchLimit=e),type:"number",placeholder:"留空显示全部"},null,512),[[r,l.value.searchLimit]])]),t[28]||(t[28]=s("p",{class:"form-hint"},"每个书源显示的搜索结果数量",-1))]),s("div",$,[t[31]||(t[31]=s("label",{class:"form-label"},"显示下载日志",-1)),s("div",q,[s("label",K,[o(s("input",{type:"radio","onUpdate:modelValue":t[5]||(t[5]=e=>l.value.showDownloadLog=e),value:1},null,512),[[d,l.value.showDownloadLog]]),t[29]||(t[29]=s("span",{class:"radio-text"},"开启",-1))]),s("label",Q,[o(s("input",{type:"radio","onUpdate:modelValue":t[6]||(t[6]=e=>l.value.showDownloadLog=e),value:0},null,512),[[d,l.value.showDownloadLog]]),t[30]||(t[30]=s("span",{class:"radio-text"},"关闭",-1))])])]),s("div",W,[t[34]||(t[34]=s("label",{class:"form-label"},"保留章节缓存",-1)),s("div",Y,[s("label",Z,[o(s("input",{type:"radio","onUpdate:modelValue":t[7]||(t[7]=e=>l.value.preserveChapterCache=e),value:1},null,512),[[d,l.value.preserveChapterCache]]),t[32]||(t[32]=s("span",{class:"radio-text"},"是",-1))]),s("label",ss,[o(s("input",{type:"radio","onUpdate:modelValue":t[8]||(t[8]=e=>l.value.preserveChapterCache=e),value:0},null,512),[[d,l.value.preserveChapterCache]]),t[33]||(t[33]=s("span",{class:"radio-text"},"否",-1))])])])])]),s("div",ts,[t[45]||(t[45]=s("h2",{class:"card-title"},"爬取设置",-1)),s("div",es,[s("div",ls,[t[38]||(t[38]=s("label",{class:"form-label"},"自动更新",-1)),s("div",os,[s("label",as,[o(s("input",{type:"radio","onUpdate:modelValue":t[9]||(t[9]=e=>l.value.autoUpdate=e),value:1},null,512),[[d,l.value.autoUpdate]]),t[36]||(t[36]=s("span",{class:"radio-text"},"开启",-1))]),s("label",rs,[o(s("input",{type:"radio","onUpdate:modelValue":t[10]||(t[10]=e=>l.value.autoUpdate=e),value:0},null,512),[[d,l.value.autoUpdate]]),t[37]||(t[37]=s("span",{class:"radio-text"},"关闭",-1))])])]),s("div",ns,[t[40]||(t[40]=s("label",{class:"form-label"},"交互模式",-1)),s("div",ds,[o(s("select",{"onUpdate:modelValue":t[11]||(t[11]=e=>l.value.interactiveMode=e)},t[39]||(t[39]=[s("option",{value:1},"模式1",-1),s("option",{value:2},"模式2",-1)]),512),[[_,l.value.interactiveMode]])])]),s("div",is,[t[41]||(t[41]=s("label",{class:"form-label"},"爬取线程数",-1)),s("div",us,[o(s("input",{"onUpdate:modelValue":t[12]||(t[12]=e=>l.value.threads=e),type:"number"},null,512),[[r,l.value.threads]])]),t[42]||(t[42]=s("p",{class:"form-hint"},"-1表示自动设置",-1))]),s("div",ps,[t[44]||(t[44]=s("label",{class:"form-label"},"爬取间隔 (毫秒)",-1)),s("div",vs,[s("div",ms,[o(s("input",{"onUpdate:modelValue":t[13]||(t[13]=e=>l.value.minInterval=e),type:"number",placeholder:"最小"},null,512),[[r,l.value.minInterval]])]),t[43]||(t[43]=s("span",null,"-",-1)),s("div",gs,[o(s("input",{"onUpdate:modelValue":t[14]||(t[14]=e=>l.value.maxInterval=e),type:"number",placeholder:"最大"},null,512),[[r,l.value.maxInterval]])])])])])]),s("div",xs,[t[49]||(t[49]=s("h2",{class:"card-title"},"重试设置",-1)),s("div",bs,[s("div",ys,[t[46]||(t[46]=s("label",{class:"form-label"},"最大重试次数",-1)),s("div",fs,[o(s("input",{"onUpdate:modelValue":t[15]||(t[15]=e=>l.value.maxRetryAttempts=e),type:"number"},null,512),[[r,l.value.maxRetryAttempts]])])]),s("div",cs,[t[48]||(t[48]=s("label",{class:"form-label"},"重试间隔 (毫秒)",-1)),s("div",ws,[s("div",Is,[o(s("input",{"onUpdate:modelValue":t[16]||(t[16]=e=>l.value.retryMinInterval=e),type:"number",placeholder:"最小"},null,512),[[r,l.value.retryMinInterval]])]),t[47]||(t[47]=s("span",null,"-",-1)),s("div",_s,[o(s("input",{"onUpdate:modelValue":t[17]||(t[17]=e=>l.value.retryMaxInterval=e),type:"number",placeholder:"最大"},null,512),[[r,l.value.retryMaxInterval]])])])])])]),s("div",Us,[t[55]||(t[55]=s("h2",{class:"card-title"},"代理设置",-1)),s("div",Vs,[s("div",ks,[t[52]||(t[52]=s("label",{class:"form-label"},"HTTP代理",-1)),s("div",Cs,[s("label",hs,[o(s("input",{type:"radio","onUpdate:modelValue":t[18]||(t[18]=e=>l.value.proxyEnabled=e),value:1},null,512),[[d,l.value.proxyEnabled]]),t[50]||(t[50]=s("span",{class:"radio-text"},"开启",-1))]),s("label",Ss,[o(s("input",{type:"radio","onUpdate:modelValue":t[19]||(t[19]=e=>l.value.proxyEnabled=e),value:0},null,512),[[d,l.value.proxyEnabled]]),t[51]||(t[51]=s("span",{class:"radio-text"},"关闭",-1))])])]),s("div",Ms,[t[53]||(t[53]=s("label",{class:"form-label"},"代理主机",-1)),s("div",{class:g(["glass-input",{disabled:!l.value.proxyEnabled}])},[o(s("input",{"onUpdate:modelValue":t[20]||(t[20]=e=>l.value.proxyHost=e),type:"text",disabled:!l.value.proxyEnabled},null,8,Es),[[r,l.value.proxyHost]])],2)]),s("div",Ts,[t[54]||(t[54]=s("label",{class:"form-label"},"代理端口",-1)),s("div",{class:g(["glass-input",{disabled:!l.value.proxyEnabled}])},[o(s("input",{"onUpdate:modelValue":t[21]||(t[21]=e=>l.value.proxyPort=e),type:"number",disabled:!l.value.proxyEnabled},null,8,Ls),[[r,l.value.proxyPort]])],2)])])]),s("div",Ps,[s("button",{type:"submit",class:"glass-button primary",disabled:m.value},[m.value?(i(),n("svg",Ns,t[56]||(t[56]=[s("circle",{class:"spinner-path",cx:"12",cy:"12",r:"10"},null,-1)]))):(i(),n("span",js,"保存设置"))],8,Ds)])],32)]),s("div",Bs,[t[58]||(t[58]=s("h2",{class:"card-title"},"数据源信息",-1)),s("div",Fs,[s("table",Os,[t[57]||(t[57]=s("thead",null,[s("tr",null,[s("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider border-b border-gray-200"}," 书源 ID "),s("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider border-b border-gray-200"}," 书源名称 "),s("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider border-b border-gray-200"}," 大陆 IP "),s("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider border-b border-gray-200"}," 非大陆 IP "),s("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider border-b border-gray-200"}," 支持搜索 "),s("th",{class:"px-4 py-3 text-left text-xs font-medium text-gray-600 uppercase tracking-wider border-b border-gray-200"}," 需要注意 ")])],-1)),s("tbody",null,[(i(!0),n(M,null,E(b.value,e=>(i(),n("tr",{key:e.id,class:"hover:bg-white hover:bg-opacity-20 transition-colors"},[s("td",As,v(e.id),1),s("td",Gs,v(e.name),1),s("td",Rs,[s("span",{class:g(y(e.mainlandIp))},v(f(e.mainlandIp)),3)]),s("td",Hs,[s("span",{class:g(y(e.nonMainlandIp))},v(f(e.nonMainlandIp)),3)]),s("td",zs,[s("span",{class:g(y(e.supportSearch))},v(f(e.supportSearch)),3)]),s("td",Js,v(e.note||"-"),1)]))),128))])])])]),u.value.show?(i(),n("div",{key:0,class:g(["fixed bottom-4 right-4 glass-toast flex items-center p-4 space-x-4 text-sm rounded-2xl shadow-lg transition-all duration-300",{"bg-green-50 bg-opacity-80 text-green-800":u.value.type==="success","bg-red-50 bg-opacity-80 text-red-800":u.value.type==="error"}])},[u.value.type==="success"?(i(),n("svg",Xs,t[59]||(t[59]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 13l4 4L19 7"},null,-1)]))):(i(),n("svg",$s,t[60]||(t[60]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"},null,-1)]))),s("p",null,v(u.value.message),1)],2)):T("",!0)])]))}},Ys=C(qs,[["__scopeId","data-v-000301ee"]]);export{Ys as default};
